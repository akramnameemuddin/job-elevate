{% extends 'dashboard/base.html' %}
{% load static %}
{% block content %}
<!-- Breadcrumb Navigation -->
<div class="breadcrumb">
    <div class="breadcrumb-item">
        <a href="{% url 'dashboard:home' %}" class="breadcrumb-link">Home</a>
        <i class='bx bx-chevron-right'></i>
    </div>
    <div class="breadcrumb-item">
        <span>Learning Progress</span>
    </div>
</div>

<!-- Page Title -->
<div class="page-content-header">
    <h1 class="page-title">Learning Progress</h1>
    <div class="page-actions">
        <button class="btn btn-primary">
            <i class='bx bx-plus'></i>
            Start New Course
        </button>
    </div>
</div>

<style>
    /* Learning Dashboard Styles - Using base theme */
    .pending-modules-container {
        background: var(--card-bg);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border-color);
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-size: var(--font-size-2xl);
        font-weight: 600;
        color: var(--heading-color);
        margin-bottom: var(--spacing-lg);
    }

    .section-title i {
        color: var(--primary-color);
        font-size: var(--font-size-3xl);
    }

    .modules-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: var(--spacing-lg);
    }

    .module-card {
        background: var(--card-bg);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border-color);
        transition: var(--transition);
        position: relative;
        overflow: hidden;
    }

    .module-card.pending {
        border-left: 4px solid var(--warning-color);
    }

    .module-card.in-progress {
        border-left: 4px solid var(--primary-color);
    }

    .module-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .module-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
    }

    .module-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--heading-color);
        margin-bottom: 0.5rem;
    }

    .learning-dashboard-container .module-status {
        /* Uses base badge system */
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: 9999px;
        font-size: var(--font-size-xs);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.025em;
    }

    .learning-dashboard-container .module-status.pending {
        background: var(--warning-light);
        color: var(--warning-color);
    }

    .learning-dashboard-container .module-status.in-progress {
        background: var(--primary-light);
        color: var(--primary-color);
    }

    .learning-dashboard-container .module-description {
        color: var(--text-light);
        margin-bottom: var(--spacing);
        line-height: var(--line-height);
    }

    .learning-dashboard-container .module-progress {
        background: var(--border-light);
        border-radius: 9999px;
        height: 8px;
        margin: var(--spacing) 0;
        overflow: hidden;
    }

    .learning-dashboard-container .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
        border-radius: 9999px;
        transition: width 0.5s ease;
    }

    .learning-dashboard-container .module-meta {
        display: flex;
        justify-content: space-between;
        font-size: var(--font-size-sm);
        color: var(--text-light);
        margin-top: var(--spacing);
    }

    .learning-dashboard-container .pending-message {
        background: var(--warning-light);
        border: 1px solid var(--warning-color);
        border-radius: var(--radius-md);
        padding: var(--spacing);
        margin-top: var(--spacing);
        text-align: center;
        color: var(--warning-color);
        font-weight: 500;
    }

    .learning-dashboard-container .pending-message i {
        color: var(--warning-color);
        margin-right: var(--spacing-sm);
    }

    /* Action buttons use base button system */
    .learning-dashboard-container .btn {
        margin-top: var(--spacing);
    }

    .learning-dashboard-container .btn:hover {
        transform: translateY(-1px);
    }

    @media (max-width: 768px) {
        .modules-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<div class="pending-modules-container">
    <h3 class="section-title">
        <i class='bx bx-clock'></i>
        {% if learning_paths %}Your Learning Paths{% else %}Get Started with Learning{% endif %}
    </h3>
    
    {% if learning_paths %}
    <div class="modules-grid">
        {% for path in learning_paths %}
        <div class="module-card {% if path.status == 'not_started' %}pending{% else %}in-progress{% endif %}">
            <div class="module-header">
                <div>
                    <h4 class="module-title">{{ path.title }}</h4>
                    <span class="module-status {{ path.status }}">{{ path.get_status_display }}</span>
                </div>
            </div>
            <div class="module-body">
                <p class="module-description">{{ path.description }}</p>
                <div class="module-progress">
                    <div class="progress-fill" style="width: {{ path.progress_percentage|floatformat:0 }}%"></div>
                </div>
                <div class="module-meta">
                    <span>{{ path.courses.count }} courses</span>
                    <span>{{ path.progress_percentage|floatformat:0 }}% complete</span>
                </div>
                <a href="{% url 'learning:learning_path_detail' path.id %}" class="btn btn-primary">
                    <i class='bx bx-play'></i>
                    {% if path.status == 'not_started' %}Start Learning{% else %}Continue{% endif %}
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div style="text-align: center; padding: 3rem;">
        <i class='bx bx-book-open' style="font-size: 5rem; color: var(--text-muted); margin-bottom: 1rem;"></i>
        <h3>No Learning Paths Yet</h3>
        <p style="color: var(--text-muted); margin-bottom: 2rem;">Take an assessment to identify skill gaps and get personalized learning recommendations.</p>
        <a href="{% url 'assessments:skill_intake_dashboard' %}" class="btn btn-primary">
            <i class='bx bx-clipboard'></i> Take Assessment
        </a>
        <a href="{% url 'learning:skill_gaps' %}" class="btn btn-secondary" style="margin-left: 1rem;">
            <i class='bx bx-line-chart'></i> View Skill Gaps
        </a>
    </div>
    {% endif %}
</div>

<!-- In Progress Courses Section -->
{% if in_progress_courses %}
<div class="pending-modules-container">
    <h3 class="section-title">
        <i class='bx bx-book'></i>
        Courses in Progress
    </h3>
    <div class="modules-grid">
        {% for progress in in_progress_courses %}
        <div class="module-card in-progress">
            <div class="module-header">
                <div>
                    <h4 class="module-title">{{ progress.course.title }}</h4>
                    <span class="module-status in-progress">In Progress</span>
                </div>
            </div>
            <div class="module-body">
                <p class="module-description">{{ progress.course.description|truncatewords:20 }}</p>
                <div class="module-progress">
                    <div class="progress-fill" style="width: {{ progress.progress_percentage|floatformat:0 }}%"></div>
                </div>
                <div class="module-meta">
                    <span>{{ progress.course.skill.name }} â€¢ {{ progress.course.platform }}</span>
                    <span>{{ progress.progress_percentage|floatformat:0 }}% complete</span>
                </div>
                <a href="{% url 'learning:my_courses' %}" class="btn btn-primary">
                    <i class='bx bx-play'></i>
                    Continue Learning
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Stats & Quick Actions -->
<div class="pending-modules-container">
    <h3 class="section-title">
        <i class='bx bx-rocket'></i>
        Your Progress
    </h3>
    <div class="modules-grid">
        <div class="module-card" style="border-left: 4px solid var(--success-color);">
            <div class="module-body">
                <h4 class="module-title">{{ completed_count }} Courses Completed</h4>
                <p class="module-description">Keep up the great work!</p>
                <a href="{% url 'learning:my_courses' %}" class="btn btn-success">
                    <i class='bx bx-book'></i>
                    View My Courses
                </a>
            </div>
        </div>
        
        <div class="module-card" style="border-left: 4px solid var(--primary-color);">
            <div class="module-body">
                <h4 class="module-title">Browse Course Catalog</h4>
                <p class="module-description">Explore courses from Coursera, Udemy, and more</p>
                <a href="{% url 'learning:course_catalog' %}" class="btn btn-primary">
                    <i class='bx bx-search'></i>
                    Browse Courses
                </a>
            </div>
        </div>
        
        <div class="module-card" style="border-left: 4px solid var(--warning-color);">
            <div class="module-body">
                <h4 class="module-title">Identify Skill Gaps</h4>
                <p class="module-description">See which skills you need to develop</p>
                <a href="{% url 'learning:skill_gaps' %}" class="btn btn-warning">
                    <i class='bx bx-target-lock'></i>
                    View Gaps
                </a>
            </div>
        </div>
    </div>
</div>

{% endblock %}