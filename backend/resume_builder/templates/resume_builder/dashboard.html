{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Resume Builder | JobElevate{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<div class="breadcrumb">
    <div class="breadcrumb-item">
        <a href="{% url 'dashboard:home' %}" class="breadcrumb-link">Home</a>
        <i class='bx bx-chevron-right'></i>
    </div>
    <div class="breadcrumb-item"><span>Resume Builder</span></div>
</div>

<!-- Page Header -->
<div class="page-content-header">
    <h1 class="page-title"><i class='bx bx-file-blank'></i> Resume Builder</h1>
    <p class="page-subtitle">Create, customize, and download professional resumes built from your profile</p>
</div>



<!-- ═══ Stats Row ═══ -->
<div class="rb-stats">
    <div class="rb-stat">
        <div class="rb-stat-icon blue"><i class='bx bx-file'></i></div>
        <div class="rb-stat-body"><h3>{{ total_resumes }}</h3><p>My Resumes</p></div>
    </div>
    <div class="rb-stat">
        <div class="rb-stat-icon green"><i class='bx bx-download'></i></div>
        <div class="rb-stat-body"><h3>{{ total_downloads }}</h3><p>Downloads</p></div>
    </div>
    <div class="rb-stat">
        <div class="rb-stat-icon purple"><i class='bx bx-user-check'></i></div>
        <div class="rb-stat-body"><h3>{{ profile_completeness }}%</h3><p>Profile Ready</p></div>
    </div>
    <div class="rb-stat">
        <div class="rb-stat-icon orange"><i class='bx bx-brain'></i></div>
        <div class="rb-stat-body"><h3>{{ tailored_resumes|length }}</h3><p>AI Tailored</p></div>
    </div>
</div>

<!-- ═══ Main Two-Column Layout ═══ -->
<div class="rb-two-col">

    <!-- ── LEFT: My Resumes ──────────────────────── -->
    <div class="rb-card">
        <div class="rb-card-head">
            <h2><i class='bx bx-file'></i> My Resumes</h2>
            <span class="rb-count-badge">{{ total_resumes }}</span>
        </div>
        <div class="rb-card-body">
            {% if user_resumes %}
            <div class="rb-resume-grid">
                {% for resume in user_resumes %}
                <div class="rb-resume-tile">
                    <div class="rb-resume-icon">
                        <span>{{ user_initials }}</span>
                    </div>
                    <div class="rb-resume-info">
                        <strong>{{ resume.title }}</strong>
                        <span class="rb-resume-meta">
                            <i class='bx bx-palette'></i> {{ resume.template.name }}
                            &middot; Updated {{ resume.updated_at|timesince }} ago
                        </span>
                        <div class="rb-section-pills">
                            {% if resume.show_skills %}<span class="rb-pill">Skills</span>{% endif %}
                            {% if resume.show_experience %}<span class="rb-pill">Experience</span>{% endif %}
                            {% if resume.show_projects %}<span class="rb-pill">Projects</span>{% endif %}
                            {% if resume.show_education %}<span class="rb-pill">Education</span>{% endif %}
                        </div>
                    </div>
                    <div class="rb-resume-actions">
                        <a href="{% url 'resume_builder:edit_resume' resume.id %}" class="rb-action-btn" title="Edit"><i class='bx bx-edit'></i></a>
                        <a href="{% url 'resume_builder:preview_resume' resume.id %}" class="rb-action-btn" title="Preview"><i class='bx bx-show'></i></a>
                        <a href="{% url 'resume_builder:download_resume' resume.id %}" class="rb-action-btn green" title="Download"><i class='bx bx-download'></i></a>
                        <button class="rb-action-btn danger" onclick="openDeleteModal({{ resume.id }})" title="Delete"><i class='bx bx-trash'></i></button>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="rb-empty">
                <i class='bx bx-file-blank'></i>
                <h3>No Resumes Yet</h3>
                <p>Choose a template below to auto-build your first resume from your profile data.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- ── RIGHT: Sidebar ────────────────────────── -->
    <div class="rb-sidebar-stack">

        <!-- Profile Readiness -->
        <div class="rb-card">
            <div class="rb-card-head"><h2><i class='bx bx-user-check'></i> Profile Readiness</h2></div>
            <div class="rb-card-body" style="text-align:center">
                <div class="rb-progress-ring">
                    <svg viewBox="0 0 36 36">
                        <circle class="rb-ring-bg" cx="18" cy="18" r="15.9"></circle>
                        <circle class="rb-ring-fill" cx="18" cy="18" r="15.9"
                                stroke-dasharray="{{ profile_completeness }}, 100"
                                stroke-dashoffset="25"></circle>
                    </svg>
                    <span class="rb-ring-val">{{ profile_completeness }}%</span>
                </div>
                <p class="rb-progress-hint">
                    {% if profile_completeness < 50 %}
                    Complete your profile for a stronger resume
                    {% elif profile_completeness < 80 %}
                    Good progress — add more details!
                    {% else %}
                    Your profile is resume-ready!
                    {% endif %}
                </p>
                <a href="{% url 'dashboard:profile' %}" class="rb-link-btn"><i class='bx bx-edit'></i> Update Profile</a>
            </div>
        </div>

        <!-- AI Tailored Resumes -->
        {% if tailored_resumes %}
        <div class="rb-card">
            <div class="rb-card-head">
                <h2><i class='bx bx-brain'></i> AI Tailored</h2>
                <span class="rb-count-badge purple">{{ tailored_resumes|length }}</span>
            </div>
            <div class="rb-card-body">
                <div class="rb-tailored-list">
                    {% for tr in tailored_resumes %}
                    <a href="{% url 'resume_builder:ai_review' tr.id %}" class="rb-tailored-item">
                        <div class="rb-tailored-info">
                            <strong>{{ tr.job.title|truncatechars:26 }}</strong>
                            <small>{{ tr.job.company|default:"—" }} &middot; {{ tr.get_status_display }}</small>
                        </div>
                        <div style="display:flex;align-items:center;gap:.4rem;">
                            {% if tr.status == 'applied' %}
                            <a href="{% url 'resume_builder:download_tailored' tr.id %}" class="rb-action-btn green" title="Download PDF" onclick="event.stopPropagation()"><i class='bx bx-download'></i></a>
                            {% endif %}
                            <span class="rb-match-pill {% if tr.match_score_after >= 70 %}high{% elif tr.match_score_after >= 40 %}med{% else %}low{% endif %}">
                                {{ tr.match_score_after }}%
                            </span>
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Quick Actions -->
        <div class="rb-card">
            <div class="rb-card-head"><h2><i class='bx bx-bolt'></i> Quick Actions</h2></div>
            <div class="rb-card-body">
                <div class="rb-qa">
                    <a href="{% url 'dashboard:profile' %}" class="rb-qa-btn"><i class='bx bx-user'></i> Edit Profile</a>
                    <a href="{% url 'jobs:job_listings' %}" class="rb-qa-btn"><i class='bx bx-briefcase'></i> Browse Jobs</a>
                    <a href="{% url 'assessments:skill_profile' %}" class="rb-qa-btn"><i class='bx bx-badge-check'></i> Skill Profile</a>
                    <a href="{% url 'learning:learning_dashboard' %}" class="rb-qa-btn"><i class='bx bx-book-open'></i> Learning Hub</a>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- ═══ Templates Section ═══ -->
<div class="rb-card" style="margin-bottom:1.5rem">
    <div class="rb-card-head">
        <h2><i class='bx bx-grid-alt'></i> Choose a Template</h2>
        <span class="rb-count-badge">{{ resume_templates|length }}</span>
    </div>
    <div class="rb-card-body">
        {% if resume_templates %}
        <div class="rb-template-grid">
            {% for template in resume_templates %}
            <div class="rb-template-tile">
                <div class="rb-template-preview">
                    {% if template.preview_image %}
                    <img src="{{ template.preview_image.url }}" alt="{{ template.name }}">
                    {% else %}
                    {% with tname=template.name|lower %}
                    {% if "modern" in tname %}
                    <div class="rb-template-svg modern-preview">
                        <div class="tp-header tp-modern-header"></div>
                        <div class="tp-body">
                            <div class="tp-line tp-line-title"></div>
                            <div class="tp-line tp-line-short"></div>
                            <div class="tp-divider"></div>
                            <div class="tp-line"></div>
                            <div class="tp-line tp-line-med"></div>
                            <div class="tp-line tp-line-short"></div>
                            <div class="tp-divider"></div>
                            <div class="tp-line tp-line-med"></div>
                            <div class="tp-line"></div>
                            <div class="tp-line tp-line-short"></div>
                        </div>
                    </div>
                    {% elif "professional" in tname %}
                    <div class="rb-template-svg professional-preview">
                        <div class="tp-header tp-pro-header">
                            <div class="tp-pro-name"></div>
                            <div class="tp-pro-role"></div>
                        </div>
                        <div class="tp-body">
                            <div class="tp-line tp-line-title"></div>
                            <div class="tp-line"></div>
                            <div class="tp-line tp-line-med"></div>
                            <div class="tp-divider tp-divider-dark"></div>
                            <div class="tp-line tp-line-title"></div>
                            <div class="tp-line"></div>
                            <div class="tp-line tp-line-short"></div>
                        </div>
                    </div>
                    {% elif "creative" in tname %}
                    <div class="rb-template-svg creative-preview">
                        <div class="tp-sidebar">
                            <div class="tp-avatar"></div>
                            <div class="tp-sidebar-line"></div>
                            <div class="tp-sidebar-line tp-sidebar-short"></div>
                            <div class="tp-sidebar-line"></div>
                            <div class="tp-sidebar-line tp-sidebar-short"></div>
                        </div>
                        <div class="tp-body" style="margin-left:38%">
                            <div class="tp-line tp-line-title"></div>
                            <div class="tp-line"></div>
                            <div class="tp-line tp-line-med"></div>
                            <div class="tp-line tp-line-short"></div>
                            <div class="tp-line"></div>
                        </div>
                    </div>
                    {% else %}
                    <div class="rb-template-placeholder"><i class='bx bx-file-blank'></i></div>
                    {% endif %}
                    {% endwith %}
                    {% endif %}
                </div>
                <div class="rb-template-bottom">
                    <div class="rb-template-info">
                        <strong>{{ template.name }}</strong>
                        <p>{{ template.description|truncatechars:70 }}</p>
                    </div>
                    <a href="{% url 'resume_builder:create_resume' %}?template_id={{ template.id }}" class="rb-use-btn">
                        <i class='bx bx-plus'></i> Use Template
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="rb-empty-sm"><p>No templates available yet.</p></div>
        {% endif %}
    </div>
</div>

<!-- ═══ Delete Modal ═══ -->
<div class="rb-overlay" id="rb-delete-overlay" style="display:none">
    <div class="rb-modal">
        <div class="rb-modal-head">
            <h3>Delete Resume</h3>
            <button class="rb-modal-close" onclick="closeDeleteModal()">&times;</button>
        </div>
        <div class="rb-modal-body">
            <p>Are you sure you want to delete this resume? This action cannot be undone.</p>
        </div>
        <div class="rb-modal-foot">
            <button class="rb-btn-cancel" onclick="closeDeleteModal()">Cancel</button>
            <form id="rb-delete-form" method="post">
                {% csrf_token %}
                <button type="submit" class="rb-btn-danger">Delete</button>
            </form>
        </div>
    </div>
</div>

<!-- ═══════════════════════════════════════════════════════════ -->
<style>
/* ── Stats ──────────────────────────────── */
.rb-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.25rem;margin-bottom:1.75rem}
.rb-stat{display:flex;align-items:center;gap:1rem;padding:1.2rem;background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);transition:var(--transition)}
.rb-stat:hover{box-shadow:var(--shadow)}
.rb-stat-icon{width:54px;height:54px;border-radius:var(--radius-lg);display:flex;align-items:center;justify-content:center;font-size:1.5rem;flex-shrink:0}
.rb-stat-icon.blue{background:var(--info-light);color:var(--info-color)}
.rb-stat-icon.green{background:var(--success-light);color:var(--success-color)}
.rb-stat-icon.purple{background:var(--secondary-light,rgba(139,92,246,.12));color:var(--secondary-color,#8b5cf6)}
.rb-stat-icon.orange{background:var(--warning-light);color:var(--warning-color)}
.rb-stat-body h3{font-size:1.6rem;font-weight:700;margin:0;color:var(--heading-color)}
.rb-stat-body p{margin:0;color:var(--text-muted);font-size:.82rem}

/* ── Two-column ─────────────────────────── */
.rb-two-col{display:grid;grid-template-columns:1.6fr 1fr;gap:1.5rem;margin-bottom:1.5rem}
.rb-sidebar-stack{display:flex;flex-direction:column;gap:1.5rem}

/* ── Card shell ─────────────────────────── */
.rb-card{background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);overflow:hidden}
.rb-card-head{display:flex;justify-content:space-between;align-items:center;padding:1.15rem 1.4rem;border-bottom:1px solid var(--border-color)}
.rb-card-head h2{font-size:1.1rem;font-weight:600;margin:0;display:flex;align-items:center;gap:.45rem;color:var(--heading-color)}
.rb-card-body{padding:1.4rem}

.rb-count-badge{display:inline-flex;align-items:center;justify-content:center;min-width:28px;height:28px;padding:0 .55rem;border-radius:var(--radius-full);font-size:.82rem;font-weight:700;background:var(--primary-color);color:var(--text-inverse)}
.rb-count-badge.purple{background:var(--secondary-color,#8b5cf6)}

/* ── Resume Tiles ───────────────────────── */
.rb-resume-grid{display:flex;flex-direction:column;gap:.75rem}

.rb-resume-tile{display:flex;align-items:center;gap:1rem;padding:1rem;background:var(--hover-bg);border:1px solid var(--border-color);border-radius:var(--radius);transition:var(--transition)}
.rb-resume-tile:hover{box-shadow:var(--shadow-sm);border-color:var(--primary-color)}

.rb-resume-icon{width:48px;height:48px;border-radius:var(--radius);background:var(--primary-color);color:var(--text-inverse);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.95rem;flex-shrink:0}

.rb-resume-info{flex:1;min-width:0;display:flex;flex-direction:column;gap:.2rem}
.rb-resume-info strong{font-size:.92rem;color:var(--heading-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rb-resume-meta{font-size:.75rem;color:var(--text-muted);display:flex;align-items:center;gap:.25rem}
.rb-resume-meta i{font-size:.85rem}

.rb-section-pills{display:flex;flex-wrap:wrap;gap:.3rem;margin-top:.25rem}
.rb-pill{font-size:.65rem;padding:.1rem .45rem;border-radius:var(--radius-full);background:var(--info-light);color:var(--info-color);font-weight:600}

.rb-resume-actions{display:flex;gap:.35rem;flex-shrink:0}
.rb-action-btn{width:34px;height:34px;border-radius:var(--radius);display:flex;align-items:center;justify-content:center;background:var(--card-bg);border:1px solid var(--border-color);color:var(--heading-color);cursor:pointer;transition:var(--transition);text-decoration:none;font-size:1rem}
.rb-action-btn:hover{background:var(--primary-color);color:var(--text-inverse);border-color:var(--primary-color)}
.rb-action-btn.green:hover{background:var(--success-color);border-color:var(--success-color)}
.rb-action-btn.danger:hover{background:var(--danger-color);border-color:var(--danger-color)}

/* ── Profile Readiness Ring ─────────────── */
.rb-progress-ring{position:relative;width:90px;height:90px;margin:0 auto .75rem}
.rb-progress-ring svg{width:100%;height:100%;transform:rotate(-90deg)}
.rb-ring-bg{fill:none;stroke:var(--border-color);stroke-width:3}
.rb-ring-fill{fill:none;stroke:var(--success-color);stroke-width:3;stroke-linecap:round;transition:stroke-dasharray .6s ease}
.rb-ring-val{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:1.1rem;font-weight:700;color:var(--heading-color)}
.rb-progress-hint{font-size:.82rem;color:var(--text-muted);margin-bottom:.75rem}
.rb-link-btn{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .85rem;border-radius:var(--radius);background:var(--hover-bg);color:var(--heading-color);text-decoration:none;font-size:.82rem;font-weight:500;transition:var(--transition)}
.rb-link-btn:hover{background:var(--primary-color);color:var(--text-inverse)}

/* ── Tailored List ──────────────────────── */
.rb-tailored-list{display:flex;flex-direction:column;gap:.5rem}
.rb-tailored-item{display:flex;align-items:center;justify-content:space-between;gap:.75rem;padding:.75rem;border-radius:var(--radius);background:var(--hover-bg);text-decoration:none;transition:var(--transition)}
.rb-tailored-item:hover{background:var(--border-color)}
.rb-tailored-info{min-width:0}
.rb-tailored-info strong{display:block;font-size:.85rem;color:var(--heading-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rb-tailored-info small{font-size:.72rem;color:var(--text-muted)}
.rb-match-pill{padding:.2rem .55rem;border-radius:var(--radius-full);font-size:.72rem;font-weight:700;flex-shrink:0}
.rb-match-pill.high{background:var(--success-light);color:var(--success-color)}
.rb-match-pill.med{background:var(--warning-light);color:var(--warning-color)}
.rb-match-pill.low{background:var(--danger-light);color:var(--danger-color)}

/* ── Quick Actions ──────────────────────── */
.rb-qa{display:flex;flex-direction:column;gap:.5rem}
.rb-qa-btn{display:flex;align-items:center;gap:.65rem;padding:.75rem .95rem;background:var(--hover-bg);border-radius:var(--radius);text-decoration:none;color:var(--heading-color);font-size:.88rem;font-weight:500;transition:var(--transition)}
.rb-qa-btn:hover{background:var(--primary-color);color:var(--text-inverse);transform:translateX(3px)}
.rb-qa-btn i{font-size:1.2rem}

/* ── Template Grid ──────────────────────── */
.rb-template-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1.25rem}
.rb-template-tile{background:var(--hover-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);overflow:hidden;transition:var(--transition)}
.rb-template-tile:hover{box-shadow:var(--shadow);border-color:var(--primary-color);transform:translateY(-3px)}
.rb-template-preview{height:160px;overflow:hidden;border-bottom:1px solid var(--border-color);position:relative;background:var(--card-bg)}
.rb-template-preview img{width:100%;height:100%;object-fit:cover;transition:var(--transition)}
.rb-template-tile:hover .rb-template-preview img{transform:scale(1.05)}
.rb-template-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:var(--text-muted);font-size:3rem}
/* ── Template preview mockups ── */
.rb-template-svg{width:100%;height:100%;padding:10px;box-sizing:border-box;position:relative}
.tp-line{height:5px;border-radius:3px;background:#c8d0e0;margin:5px 0}
.tp-line-title{height:7px;background:#8a99b8;width:55%}
.tp-line-med{width:75%}
.tp-line-short{width:45%}
.tp-divider{height:1px;background:#cbd3e0;margin:8px 0}
.tp-divider-dark{background:#8a99b8}
/* Modern */
.modern-preview{background:#f4f6fc}
.tp-modern-header{height:32px;background:linear-gradient(90deg,#4f46e5,#7c3aed);border-radius:4px;margin-bottom:10px}
/* Professional */
.professional-preview{background:#fafafa}
.tp-pro-header{background:#1e293b;border-radius:4px;padding:8px;margin-bottom:10px;display:flex;flex-direction:column;gap:4px}
.tp-pro-name{height:8px;background:#fff;border-radius:2px;width:60%}
.tp-pro-role{height:5px;background:rgba(255,255,255,.5);border-radius:2px;width:40%}
/* Creative */
.creative-preview{background:#fff8f0;display:flex;position:relative;overflow:hidden}
.tp-sidebar{position:absolute;top:0;left:0;width:35%;height:100%;background:linear-gradient(160deg,#f97316,#ef4444);padding:10px;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;gap:6px}
.tp-avatar{width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,.7);margin-bottom:4px;flex-shrink:0}
.tp-sidebar-line{height:4px;border-radius:2px;background:rgba(255,255,255,.6);width:80%}
.tp-sidebar-short{width:55%}
.rb-template-bottom{padding:1rem}
.rb-template-info{margin-bottom:.75rem}
.rb-template-info strong{display:block;font-size:.92rem;color:var(--heading-color);margin-bottom:.25rem}
.rb-template-info p{font-size:.78rem;color:var(--text-muted);margin:0;line-height:1.4}
.rb-use-btn{display:flex;align-items:center;justify-content:center;gap:.4rem;width:100%;padding:.55rem;border-radius:var(--radius);background:var(--primary-color);color:var(--text-inverse);text-decoration:none;font-size:.82rem;font-weight:600;transition:var(--transition)}
.rb-use-btn:hover{opacity:.88;transform:translateY(-1px)}

/* ── Empty States ───────────────────────── */
.rb-empty{text-align:center;padding:3rem 1rem}
.rb-empty i{font-size:3.5rem;color:var(--text-muted);margin-bottom:.75rem}
.rb-empty h3{color:var(--heading-color);margin-bottom:.4rem}
.rb-empty p{color:var(--text-muted);margin-bottom:1.25rem}
.rb-empty-sm{text-align:center;padding:2rem 1rem}
.rb-empty-sm p{color:var(--text-muted);margin:0}

/* ── Delete Modal ───────────────────────── */
.rb-overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:1000;display:flex;align-items:center;justify-content:center}
.rb-modal{background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);width:90%;max-width:420px;box-shadow:var(--shadow-lg)}
.rb-modal-head{display:flex;justify-content:space-between;align-items:center;padding:1.15rem 1.4rem;border-bottom:1px solid var(--border-color)}
.rb-modal-head h3{margin:0;font-size:1.1rem;color:var(--heading-color)}
.rb-modal-close{background:none;border:none;font-size:1.4rem;color:var(--text-muted);cursor:pointer}
.rb-modal-close:hover{color:var(--heading-color)}
.rb-modal-body{padding:1.4rem}
.rb-modal-body p{color:var(--text-muted);margin:0}
.rb-modal-foot{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.4rem;border-top:1px solid var(--border-color)}
.rb-btn-cancel{padding:.5rem 1rem;border-radius:var(--radius);border:1px solid var(--border-color);background:var(--hover-bg);color:var(--heading-color);cursor:pointer;font-size:.85rem;transition:var(--transition)}
.rb-btn-cancel:hover{background:var(--border-color)}
.rb-btn-danger{padding:.5rem 1rem;border-radius:var(--radius);border:none;background:var(--danger-color);color:#fff;cursor:pointer;font-size:.85rem;font-weight:600;transition:var(--transition)}
.rb-btn-danger:hover{opacity:.88}

/* ── Responsive ─────────────────────────── */
@media(max-width:1100px){.rb-two-col{grid-template-columns:1fr}}
@media(max-width:700px){
    .rb-stats{grid-template-columns:repeat(2,1fr)}
    .rb-template-grid{grid-template-columns:1fr}
    .rb-resume-tile{flex-direction:column;text-align:center}
    .rb-resume-actions{justify-content:center}
}
</style>

<script>
function openDeleteModal(resumeId){
    document.getElementById('rb-delete-form').action='{% url "resume_builder:delete_resume" 0 %}'.replace('0', resumeId);
    document.getElementById('rb-delete-overlay').style.display='flex';
}
function closeDeleteModal(){
    document.getElementById('rb-delete-overlay').style.display='none';
}
document.addEventListener('keydown',function(e){
    if(e.key==='Escape')closeDeleteModal();
});
document.getElementById('rb-delete-overlay').addEventListener('click',function(e){
    if(e.target===this)closeDeleteModal();
});
// Auto-close notifications handled by base.html
</script>
{% endblock %}
