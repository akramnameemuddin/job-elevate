{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Edit Resume | JobElevate{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<div class="breadcrumb">
    <div class="breadcrumb-item">
        <a href="{% url 'dashboard:home' %}" class="breadcrumb-link">Home</a>
        <i class='bx bx-chevron-right'></i>
    </div>
    <div class="breadcrumb-item">
        <a href="{% url 'resume_builder:resume_builder' %}" class="breadcrumb-link">Resume Builder</a>
        <i class='bx bx-chevron-right'></i>
    </div>
    <div class="breadcrumb-item"><span>{{ resume.title }}</span></div>
</div>

<!-- Page Header -->
<div class="page-content-header">
    <h1 class="page-title"><i class='bx bx-edit'></i> {{ resume.title }}</h1>
    <p class="page-subtitle">Template: {{ resume.template.name }} &middot; Auto-filled from your profile</p>
</div>

<!-- Messages -->
{% if messages %}
<div class="notification-container">
    {% for message in messages %}
    <div class="notification {{ message.tags }}">
        <i class='bx {% if message.tags == "success" %}bx-check-circle{% elif message.tags == "error" %}bx-error{% else %}bx-info-circle{% endif %}'></i>
        <span>{{ message }}</span>
        <button class="notification-close" onclick="this.parentElement.remove()"><i class='bx bx-x'></i></button>
    </div>
    {% endfor %}
</div>
{% endif %}

<form method="post" id="resume-form">
{% csrf_token %}

<!-- ═══ Two-Column Layout ═══ -->
<div class="re-two-col">

    <!-- ── LEFT: Resume Sections (auto-filled) ──── -->
    <div class="re-main">

        <!-- Resume Title -->
        <div class="re-card">
            <div class="re-card-head">
                <h2><i class='bx bx-text'></i> Resume Title</h2>
            </div>
            <div class="re-card-body">
                <input type="text" name="title" value="{{ resume.title }}" class="re-input" placeholder="e.g. Software Engineer Resume">
            </div>
        </div>

        <!-- Contact Info -->
        <div class="re-card re-section {% if not resume.show_contact %}re-disabled{% endif %}" id="section-contact">
            <div class="re-card-head">
                <h2><i class='bx bx-user'></i> Contact Information</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_contact" {% if resume.show_contact %}checked{% endif %} onchange="toggleSection('contact')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                <div class="re-field-grid">
                    <div class="re-field">
                        <span class="re-field-label">Full Name</span>
                        <span class="re-field-value">{{ user_profile.full_name|default:"—" }}</span>
                    </div>
                    <div class="re-field">
                        <span class="re-field-label">Email</span>
                        <span class="re-field-value">{{ user_profile.email|default:"—" }}</span>
                    </div>
                    <div class="re-field">
                        <span class="re-field-label">Phone</span>
                        <span class="re-field-value">{{ user_profile.phone_number|default:"—" }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Professional Links -->
        <div class="re-card re-section {% if not resume.show_links %}re-disabled{% endif %}" id="section-links">
            <div class="re-card-head">
                <h2><i class='bx bx-link'></i> Professional Links</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_links" {% if resume.show_links %}checked{% endif %} onchange="toggleSection('links')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                <div class="re-field-grid">
                    {% if user_profile.linkedin_profile %}
                    <div class="re-field">
                        <span class="re-field-label"><i class='bx bxl-linkedin'></i> LinkedIn</span>
                        <span class="re-field-value">{{ user_profile.linkedin_profile }}</span>
                    </div>
                    {% endif %}
                    {% if user_profile.github_profile %}
                    <div class="re-field">
                        <span class="re-field-label"><i class='bx bxl-github'></i> GitHub</span>
                        <span class="re-field-value">{{ user_profile.github_profile }}</span>
                    </div>
                    {% endif %}
                    {% if user_profile.portfolio_website %}
                    <div class="re-field">
                        <span class="re-field-label"><i class='bx bx-globe'></i> Portfolio</span>
                        <span class="re-field-value">{{ user_profile.portfolio_website }}</span>
                    </div>
                    {% endif %}
                    {% if not user_profile.linkedin_profile and not user_profile.github_profile and not user_profile.portfolio_website %}
                    <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No links in your profile. <a href="{% url 'dashboard:profile' %}">Add them →</a></div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Professional Summary -->
        <div class="re-card re-section {% if not resume.show_objective %}re-disabled{% endif %}" id="section-objective">
            <div class="re-card-head">
                <h2><i class='bx bx-message-square-detail'></i> Professional Summary</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_objective" {% if resume.show_objective %}checked{% endif %} onchange="toggleSection('objective')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if user_profile.objective %}
                <p class="re-preview-text">{{ user_profile.objective }}</p>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No summary in your profile. <a href="{% url 'dashboard:profile' %}">Add one →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Education -->
        <div class="re-card re-section {% if not resume.show_education %}re-disabled{% endif %}" id="section-education">
            <div class="re-card-head">
                <h2><i class='bx bx-book-reader'></i> Education</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_education" {% if resume.show_education %}checked{% endif %} onchange="toggleSection('education')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if user_profile.university or user_profile.degree %}
                <div class="re-edu-item">
                    <div class="re-edu-icon"><i class='bx bx-graduation'></i></div>
                    <div class="re-edu-info">
                        <strong>{{ user_profile.degree|default:"Degree" }}</strong>
                        <span>{{ user_profile.university|default:"University" }}</span>
                        {% if user_profile.graduation_year %}<small>Class of {{ user_profile.graduation_year }}{% if user_profile.cgpa %} &middot; CGPA: {{ user_profile.cgpa }}{% endif %}</small>{% endif %}
                    </div>
                </div>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No education data. <a href="{% url 'dashboard:profile' %}">Add it →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Skills -->
        <div class="re-card re-section {% if not resume.show_skills %}re-disabled{% endif %}" id="section-skills">
            <div class="re-card-head">
                <h2><i class='bx bx-code-alt'></i> Technical Skills</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_skills" {% if resume.show_skills %}checked{% endif %} onchange="toggleSection('skills')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if technical_skills %}
                <div class="re-skill-chips">
                    {% for skill in technical_skills %}
                    <span class="re-chip">{{ skill }}</span>
                    {% endfor %}
                </div>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No skills found. <a href="{% url 'dashboard:profile' %}">Add skills →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Work Experience -->
        <div class="re-card re-section {% if not resume.show_experience %}re-disabled{% endif %}" id="section-experience">
            <div class="re-card-head">
                <h2><i class='bx bx-briefcase'></i> Work Experience</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_experience" {% if resume.show_experience %}checked{% endif %} onchange="toggleSection('experience')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if work_experience %}
                <div class="re-exp-list">
                    {% for job in work_experience %}
                    <div class="re-exp-item">
                        <div class="re-exp-dot"></div>
                        <div class="re-exp-info">
                            <strong>{{ job.title }} <span class="re-company">at {{ job.company }}</span></strong>
                            <small>{{ job.start_date }} – {{ job.end_date|default:"Present" }}</small>
                            {% if job.description %}<p>{{ job.description|truncatechars:200 }}</p>{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No work experience. <a href="{% url 'dashboard:profile' %}">Add it →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Internships (students only) -->
        {% if user_profile.user_type == 'student' and internships %}
        <div class="re-card re-section" id="section-internships">
            <div class="re-card-head">
                <h2><i class='bx bx-building'></i> Internships</h2>
            </div>
            <div class="re-card-body">
                <div class="re-exp-list">
                    {% for intern in internships %}
                    <div class="re-exp-item">
                        <div class="re-exp-dot"></div>
                        <div class="re-exp-info">
                            <strong>{{ intern.title }} <span class="re-company">at {{ intern.company }}</span></strong>
                            <small>{{ intern.start_date }} – {{ intern.end_date|default:"Present" }}</small>
                            {% if intern.description %}<p>{{ intern.description|truncatechars:200 }}</p>{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Projects -->
        <div class="re-card re-section {% if not resume.show_projects %}re-disabled{% endif %}" id="section-projects">
            <div class="re-card-head">
                <h2><i class='bx bx-folder-open'></i> Projects</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_projects" {% if resume.show_projects %}checked{% endif %} onchange="toggleSection('projects')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if projects %}
                <div class="re-project-grid">
                    {% for project in projects %}
                    <div class="re-project-item">
                        <strong>{{ project.title }}</strong>
                        {% if project.description %}<p>{{ project.description|truncatechars:150 }}</p>{% endif %}
                        {% if project.technologies %}
                        <div class="re-tech-pills">
                            {% for tech in project.technologies|truncatechars:60 %}{% endfor %}
                            <span class="re-tech-pill">{{ project.technologies }}</span>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No projects. <a href="{% url 'dashboard:profile' %}">Add projects →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Certifications -->
        <div class="re-card re-section {% if not resume.show_certifications %}re-disabled{% endif %}" id="section-certifications">
            <div class="re-card-head">
                <h2><i class='bx bx-certification'></i> Certifications</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_certifications" {% if resume.show_certifications %}checked{% endif %} onchange="toggleSection('certifications')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if certifications %}
                <div class="re-cert-list">
                    {% for cert in certifications %}
                    <div class="re-cert-item">
                        <i class='bx bx-award'></i>
                        <div>
                            <strong>{{ cert.name }}</strong>
                            {% if cert.issuing_organization %}<small>{{ cert.issuing_organization }}{% if cert.date %} &middot; {{ cert.date }}{% endif %}</small>{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No certifications. <a href="{% url 'dashboard:profile' %}">Add some →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Achievements -->
        <div class="re-card re-section {% if not resume.show_achievements %}re-disabled{% endif %}" id="section-achievements">
            <div class="re-card-head">
                <h2><i class='bx bx-trophy'></i> Achievements</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_achievements" {% if resume.show_achievements %}checked{% endif %} onchange="toggleSection('achievements')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if user_profile.achievements %}
                <p class="re-preview-text">{{ user_profile.achievements }}</p>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> No achievements listed. <a href="{% url 'dashboard:profile' %}">Add them →</a></div>
                {% endif %}
            </div>
        </div>

        <!-- Extracurricular -->
        <div class="re-card re-section {% if not resume.show_extracurricular %}re-disabled{% endif %}" id="section-extracurricular">
            <div class="re-card-head">
                <h2><i class='bx bx-group'></i> Extracurricular Activities</h2>
                <label class="re-toggle">
                    <input type="checkbox" name="show_extracurricular" {% if resume.show_extracurricular %}checked{% endif %} onchange="toggleSection('extracurricular')">
                    <span class="re-toggle-slider"></span>
                </label>
            </div>
            <div class="re-card-body">
                {% if user_profile.extracurricular_activities %}
                <p class="re-preview-text">{{ user_profile.extracurricular_activities }}</p>
                {% else %}
                <div class="re-empty-hint"><i class='bx bx-info-circle'></i> None listed. <a href="{% url 'dashboard:profile' %}">Add activities →</a></div>
                {% endif %}
            </div>
        </div>

    </div>

    <!-- ── RIGHT: Settings Sidebar ──────────────── -->
    <div class="re-sidebar">

        <!-- Template Info -->
        <div class="re-card">
            <div class="re-card-head"><h2><i class='bx bx-palette'></i> Style Settings</h2></div>
            <div class="re-card-body">
                <div class="re-setting">
                    <label>Primary Color</label>
                    <input type="color" name="primary_color" value="{{ resume.primary_color }}" class="re-color-input">
                </div>
                <div class="re-setting">
                    <label>Secondary Color</label>
                    <input type="color" name="secondary_color" value="{{ resume.secondary_color }}" class="re-color-input">
                </div>
                <div class="re-setting">
                    <label>Font Family</label>
                    <select name="font_family" class="re-select">
                        <option value="Roboto, sans-serif" {% if resume.font_family == "Roboto, sans-serif" %}selected{% endif %}>Roboto</option>
                        <option value="Inter, sans-serif" {% if resume.font_family == "Inter, sans-serif" %}selected{% endif %}>Inter</option>
                        <option value="Georgia, serif" {% if resume.font_family == "Georgia, serif" %}selected{% endif %}>Georgia</option>
                        <option value="'Courier New', monospace" {% if resume.font_family == "'Courier New', monospace" %}selected{% endif %}>Courier New</option>
                        <option value="Arial, sans-serif" {% if resume.font_family == "Arial, sans-serif" %}selected{% endif %}>Arial</option>
                        <option value="'Times New Roman', serif" {% if resume.font_family == "'Times New Roman', serif" %}selected{% endif %}>Times New Roman</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Section Checklist -->
        <div class="re-card">
            <div class="re-card-head"><h2><i class='bx bx-list-check'></i> Sections Included</h2></div>
            <div class="re-card-body">
                <div class="re-checklist">
                    <div class="re-check-item"><i class='bx {% if resume.show_contact %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_contact %}active{% endif %}'></i> Contact</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_links %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_links %}active{% endif %}'></i> Links</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_objective %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_objective %}active{% endif %}'></i> Summary</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_education %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_education %}active{% endif %}'></i> Education</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_skills %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_skills %}active{% endif %}'></i> Skills</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_experience %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_experience %}active{% endif %}'></i> Experience</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_projects %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_projects %}active{% endif %}'></i> Projects</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_certifications %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_certifications %}active{% endif %}'></i> Certifications</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_achievements %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_achievements %}active{% endif %}'></i> Achievements</div>
                    <div class="re-check-item"><i class='bx {% if resume.show_extracurricular %}bx-check-circle{% else %}bx-circle{% endif %} {% if resume.show_extracurricular %}active{% endif %}'></i> Extracurricular</div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="re-card">
            <div class="re-card-head"><h2><i class='bx bx-bolt'></i> Actions</h2></div>
            <div class="re-card-body">
                <div class="re-action-stack">
                    <button type="submit" class="re-btn primary"><i class='bx bx-save'></i> Save Changes</button>
                    <button type="submit" name="preview" class="re-btn outline"><i class='bx bx-show'></i> Save & Preview</button>
                    <button type="submit" name="download" class="re-btn success"><i class='bx bx-download'></i> Save & Download</button>
                    <a href="{% url 'resume_builder:resume_builder' %}" class="re-btn ghost"><i class='bx bx-arrow-back'></i> Back to Dashboard</a>
                </div>
            </div>
        </div>

        <!-- Profile Hint -->
        <div class="re-card">
            <div class="re-card-body" style="text-align:center">
                <i class='bx bx-info-circle' style="font-size:1.5rem;color:var(--info-color);margin-bottom:.5rem"></i>
                <p style="font-size:.82rem;color:var(--text-muted);margin:0">
                    All data is pulled from your profile. 
                    <a href="{% url 'dashboard:profile' %}" style="color:var(--primary-color)">Update profile</a> to change resume content.
                </p>
            </div>
        </div>

    </div>
</div>

</form>

<!-- ═══════════════════════════════════════════════════════════ -->
<style>
/* ── Two-column layout ──────────────────── */
.re-two-col{display:grid;grid-template-columns:1fr 340px;gap:1.5rem;margin-bottom:1.5rem}
.re-main{display:flex;flex-direction:column;gap:1.25rem}
.re-sidebar{display:flex;flex-direction:column;gap:1.25rem;position:sticky;top:1rem;align-self:start;max-height:calc(100vh - 2rem);overflow-y:auto}

/* ── Card ───────────────────────────────── */
.re-card{background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);overflow:hidden}
.re-card-head{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.25rem;border-bottom:1px solid var(--border-color)}
.re-card-head h2{font-size:1rem;font-weight:600;margin:0;display:flex;align-items:center;gap:.4rem;color:var(--heading-color)}
.re-card-body{padding:1.25rem}

/* ── Section toggle disabled state ──────── */
.re-section.re-disabled .re-card-body{opacity:.35;pointer-events:none}

/* ── Toggle switch ──────────────────────── */
.re-toggle{position:relative;display:inline-block;width:44px;height:24px;cursor:pointer}
.re-toggle input{opacity:0;width:0;height:0}
.re-toggle-slider{position:absolute;inset:0;background:var(--border-color);border-radius:24px;transition:.3s}
.re-toggle-slider::before{content:'';position:absolute;width:18px;height:18px;left:3px;bottom:3px;background:var(--card-bg);border-radius:50%;transition:.3s}
.re-toggle input:checked+.re-toggle-slider{background:var(--primary-color)}
.re-toggle input:checked+.re-toggle-slider::before{transform:translateX(20px)}

/* ── Input ──────────────────────────────── */
.re-input{width:100%;padding:.7rem .9rem;border:1px solid var(--border-color);border-radius:var(--radius);background:var(--hover-bg);color:var(--heading-color);font-size:.92rem;transition:var(--transition)}
.re-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px rgba(99,102,241,.12)}

/* ── Field grid (read-only profile data) ── */
.re-field-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.85rem}
.re-field{padding:.65rem .85rem;background:var(--hover-bg);border-radius:var(--radius);border:1px solid var(--border-color)}
.re-field-label{display:block;font-size:.72rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.3px;margin-bottom:.2rem}
.re-field-label i{font-size:.85rem;vertical-align:middle;margin-right:.2rem}
.re-field-value{font-size:.88rem;color:var(--heading-color);word-break:break-all}

/* ── Preview text ───────────────────────── */
.re-preview-text{font-size:.88rem;line-height:1.65;color:var(--heading-color);padding:.75rem;background:var(--hover-bg);border-radius:var(--radius);border:1px solid var(--border-color);margin:0;white-space:pre-wrap}

/* ── Education ──────────────────────────── */
.re-edu-item{display:flex;align-items:flex-start;gap:1rem}
.re-edu-icon{width:44px;height:44px;border-radius:var(--radius);background:var(--info-light);color:var(--info-color);display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0}
.re-edu-info{display:flex;flex-direction:column;gap:.15rem}
.re-edu-info strong{font-size:.92rem;color:var(--heading-color)}
.re-edu-info span{font-size:.82rem;color:var(--text-muted)}
.re-edu-info small{font-size:.75rem;color:var(--text-muted)}

/* ── Skills chips ───────────────────────── */
.re-skill-chips{display:flex;flex-wrap:wrap;gap:.4rem}
.re-chip{font-size:.78rem;padding:.3rem .65rem;border-radius:var(--radius-full);background:var(--info-light);color:var(--info-color);font-weight:600}

/* ── Experience timeline ────────────────── */
.re-exp-list{display:flex;flex-direction:column;gap:0;position:relative;padding-left:1.5rem}
.re-exp-list::before{content:'';position:absolute;left:5px;top:8px;bottom:8px;width:2px;background:var(--border-color)}
.re-exp-item{display:flex;align-items:flex-start;gap:.85rem;padding:.75rem 0;position:relative}
.re-exp-dot{width:12px;height:12px;border-radius:50%;background:var(--primary-color);border:2px solid var(--card-bg);position:absolute;left:-1.5rem;top:1rem;z-index:1;margin-left:-1px}
.re-exp-info{flex:1}
.re-exp-info strong{font-size:.88rem;color:var(--heading-color);display:block}
.re-company{font-weight:400;color:var(--text-muted)}
.re-exp-info small{font-size:.75rem;color:var(--text-muted);display:block;margin-top:.15rem}
.re-exp-info p{font-size:.82rem;color:var(--text-muted);margin:.35rem 0 0;line-height:1.5}

/* ── Projects ───────────────────────────── */
.re-project-grid{display:flex;flex-direction:column;gap:.75rem}
.re-project-item{padding:.85rem;background:var(--hover-bg);border:1px solid var(--border-color);border-radius:var(--radius)}
.re-project-item strong{font-size:.88rem;color:var(--heading-color);display:block;margin-bottom:.25rem}
.re-project-item p{font-size:.8rem;color:var(--text-muted);margin:0;line-height:1.5}
.re-tech-pills{margin-top:.4rem}
.re-tech-pill{display:inline;font-size:.72rem;color:var(--text-muted);font-style:italic}

/* ── Certifications ─────────────────────── */
.re-cert-list{display:flex;flex-direction:column;gap:.5rem}
.re-cert-item{display:flex;align-items:flex-start;gap:.65rem;padding:.5rem 0}
.re-cert-item i{color:var(--warning-color);font-size:1.15rem;margin-top:.1rem}
.re-cert-item strong{font-size:.85rem;color:var(--heading-color);display:block}
.re-cert-item small{font-size:.75rem;color:var(--text-muted)}

/* ── Empty hint ─────────────────────────── */
.re-empty-hint{display:flex;align-items:center;gap:.5rem;padding:.65rem .85rem;background:var(--hover-bg);border-radius:var(--radius);font-size:.82rem;color:var(--text-muted)}
.re-empty-hint a{color:var(--primary-color);text-decoration:none;font-weight:500}
.re-empty-hint a:hover{text-decoration:underline}

/* ── Sidebar settings ───────────────────── */
.re-setting{margin-bottom:1rem}
.re-setting:last-child{margin-bottom:0}
.re-setting label{display:block;font-size:.82rem;font-weight:600;color:var(--heading-color);margin-bottom:.35rem}
.re-color-input{width:100%;height:38px;border:1px solid var(--border-color);border-radius:var(--radius);cursor:pointer;background:var(--hover-bg);padding:2px}
.re-select{width:100%;padding:.55rem .75rem;border:1px solid var(--border-color);border-radius:var(--radius);background:var(--hover-bg);color:var(--heading-color);font-size:.85rem}
.re-select:focus{outline:none;border-color:var(--primary-color)}

/* ── Checklist ──────────────────────────── */
.re-checklist{display:flex;flex-direction:column;gap:.4rem}
.re-check-item{display:flex;align-items:center;gap:.5rem;font-size:.82rem;color:var(--text-muted);padding:.25rem 0}
.re-check-item i{font-size:1rem}
.re-check-item i.active{color:var(--success-color)}

/* ── Buttons ────────────────────────────── */
.re-action-stack{display:flex;flex-direction:column;gap:.5rem}
.re-btn{display:flex;align-items:center;justify-content:center;gap:.45rem;width:100%;padding:.7rem;border-radius:var(--radius);font-size:.85rem;font-weight:600;cursor:pointer;transition:var(--transition);text-decoration:none;border:none}
.re-btn.primary{background:var(--primary-color);color:var(--text-inverse)}
.re-btn.primary:hover{opacity:.88}
.re-btn.outline{background:transparent;border:1px solid var(--primary-color);color:var(--primary-color)}
.re-btn.outline:hover{background:var(--primary-color);color:var(--text-inverse)}
.re-btn.success{background:var(--success-color);color:#fff}
.re-btn.success:hover{opacity:.88}
.re-btn.ghost{background:var(--hover-bg);color:var(--heading-color)}
.re-btn.ghost:hover{background:var(--border-color)}

/* ── Responsive ─────────────────────────── */
@media(max-width:1024px){
    .re-two-col{grid-template-columns:1fr}
    .re-sidebar{position:static;max-height:none}
}
@media(max-width:600px){
    .re-field-grid{grid-template-columns:1fr}
}
</style>

<script>
function toggleSection(name){
    const section=document.getElementById('section-'+name);
    const cb=section.querySelector('input[type=checkbox]');
    if(cb.checked){section.classList.remove('re-disabled')}
    else{section.classList.add('re-disabled')}
    updateChecklist();
}
function updateChecklist(){
    const map={contact:'Contact',links:'Links',objective:'Summary',education:'Education',skills:'Skills',experience:'Experience',projects:'Projects',certifications:'Certifications',achievements:'Achievements',extracurricular:'Extracurricular'};
    document.querySelectorAll('.re-check-item').forEach(item=>{
        const label=item.textContent.trim();
        for(const[key,val]of Object.entries(map)){
            if(val===label){
                const sec=document.getElementById('section-'+key);
                if(!sec)break;
                const cb=sec.querySelector('input[type=checkbox]');
                const icon=item.querySelector('i');
                if(cb&&cb.checked){
                    icon.className='bx bx-check-circle active';
                }else{
                    icon.className='bx bx-circle';
                }
                break;
            }
        }
    });
}
// Auto-close notifications
setTimeout(()=>{document.querySelectorAll('.notification').forEach(n=>{n.style.transition='opacity .5s';n.style.opacity='0';setTimeout(()=>n.remove(),500)})},5000);
</script>
{% endblock %}
